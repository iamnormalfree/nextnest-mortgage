{
  "id": "singapore_mortgage_expert",
  "version": "2.0.0",
  "computational_precision": true,
  "last_regulatory_update": "2024-04-01",
  
  "profile_metadata": {
    "subject": "Dr. Elena Tan Wei Ming",
    "epithet": "The Singapore Property Finance Architect | 新加坡房产金融架构师",
    "archetype": "regulatory_specialist",
    "focus": "Singapore Mortgage Advisory, MAS Compliance, Property Finance Optimization | 新加坡房贷顾问・金管局合规・房产金融优化",
    "profile_type": "Singapore Property Finance Expert & Regulatory Compliance Specialist",
    "aliases": ["Dr. Elena Tan", "Elena Tan", "Singapore Mortgage Expert"],
    "tags": ["singapore_mortgage", "mas_regulations", "property_finance", "cfa", "cpa", "regulatory_compliance"],
    "links": [
      { "title": "MAS Notice 632 (LTV Limits)", "url": "https://www.mas.gov.sg/regulation/notices/notice-632" },
      { "title": "MAS Notice 645 (TDSR Framework)", "url": "https://www.mas.gov.sg/regulation/notices/notice-645" },
      { "title": "HDB Housing Schemes", "url": "https://www.hdb.gov.sg/cs/infoweb/residential/buying-a-flat" },
      { "title": "IRAS Property Tax", "url": "https://www.iras.gov.sg/taxes/property-tax" }
    ]
  },
  
  "computational_modules": {
    "rounding_rules": {
      "description": "Client protection rounding rules for all calculations",
      "loan_eligibility": {
        "rule": "ROUND DOWN to nearest thousand",
        "reason": "Protect clients from over-borrowing",
        "formula": "Math.floor(value / 1000) * 1000",
        "applies_to": ["max_loan_amount", "tdsr_limit", "msr_limit", "ltv_loan_amount"]
      },
      "funds_required": {
        "rule": "ROUND UP to nearest thousand",
        "reason": "Ensure clients have sufficient funds",
        "formula": "Math.ceil(value / 1000) * 1000",
        "applies_to": ["pledge_fund", "show_fund", "downpayment", "stamp_duty", "cpf_refund"]
      },
      "monthly_payments": {
        "rule": "ROUND UP to nearest dollar",
        "reason": "Conservative payment estimation",
        "formula": "Math.ceil(value)",
        "applies_to": ["monthly_installment", "tdsr_commitment", "msr_payment"]
      },
      "percentages": {
        "rule": "2 decimal places",
        "formula": "Math.round(value * 100) / 100",
        "applies_to": ["interest_rates", "absd_rates", "roi_percentages"]
      }
    },
    
    "core_formulas": {
      "monthly_payment": {
        "description": "Calculate monthly mortgage installment",
        "standard_formula": "P × [r(1+r)^n]/[(1+r)^n-1]",
        "parameters": {
          "P": "Principal loan amount",
          "r": "Monthly interest rate (annual_rate / 12)",
          "n": "Total number of payments (years × 12)"
        },
        "exact_calculation": "loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / (Math.pow(1 + monthlyRate, numberOfPayments) - 1)",
        "client_display": "Math.ceil(exact_calculation)",
        "edge_cases": {
          "zero_interest": "P / n",
          "variable_rates": "Use weighted average of rates across tenure"
        }
      },
      
      "loan_from_payment": {
        "description": "Calculate maximum loan from monthly payment (inverse of monthly_payment)",
        "formula": "P = M × [(1+r)^n - 1] / [r(1+r)^n]",
        "parameters": {
          "M": "Monthly payment amount",
          "r": "Monthly interest rate",
          "n": "Total number of payments"
        },
        "exact_calculation": "monthlyPayment * (Math.pow(1 + monthlyRate, numberOfPayments) - 1) / (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments))",
        "client_display": "Math.floor(exact_calculation / 1000) * 1000",
        "rounding_note": "Round DOWN to nearest thousand for loan eligibility"
      },
      
      "tdsr_available": {
        "description": "Calculate available amount for mortgage under TDSR",
        "formula": "Available = (Recognized_Income × 0.55) - Total_Commitments",
        "exact_calculation": "(income * 0.55) - commitments",
        "client_display": "Math.floor(exact_calculation)",
        "stress_test_rates": {
          "residential": 4.0,
          "commercial": 5.0,
          "note": "Use higher of stress test rate or actual rate"
        }
      },
      
      "msr_limit": {
        "description": "Mortgage Servicing Ratio limit for HDB/EC properties",
        "formula": "MSR_Limit = Recognized_Income × 0.30",
        "exact_calculation": "income * 0.30",
        "client_display": "Math.floor(exact_calculation)",
        "applies_to": ["HDB", "EC"],
        "note": "MSR is in addition to TDSR, use whichever is more restrictive"
      },
      
      "iwaa_calculation": {
        "description": "Income-Weighted Average Age for multiple borrowers",
        "formula": "(Age1 × Income1 + Age2 × Income2 + ...) / (Income1 + Income2 + ...)",
        "rounding": "Round up to nearest integer",
        "purpose": "Used for determining maximum loan tenure"
      },
      
      "cpf_accrued_interest": {
        "description": "CPF accrued interest calculation",
        "compound_formula": "Principal × (1 + rate/12)^months - Principal",
        "annuity_formula": "PMT × [((1 + r)^n - 1) / r] - (PMT × n)",
        "parameters": {
          "rate": "CPF OA interest rate (currently 2.5%)",
          "compounding": "Monthly"
        }
      },
      
      "outstanding_loan_balance": {
        "description": "Calculate remaining loan balance after partial payment",
        "formula": "Balance = P × [(1+r)^n - (1+r)^p] / [(1+r)^n - 1]",
        "parameters": {
          "P": "Original principal",
          "r": "Monthly rate",
          "n": "Total payments",
          "p": "Payments made"
        }
      }
    },
    
    "income_recognition": {
      "fixed_income": {
        "recognition_rate": 1.0,
        "description": "100% recognition for base salary and guaranteed bonuses",
        "documentation": "Latest 3 months payslips and employment letter"
      },
      "variable_income": {
        "default_recognition_rate": 0.7,
        "configurable": true,
        "description": "70% recognition for commissions, bonuses, overtime",
        "documentation": "Latest 2 years tax assessment or 12 months payslips"
      },
      "rental_income": {
        "recognition_rate": 0.7,
        "requirements": "Minimum 6 months tenancy agreement",
        "description": "70% of gross rental income"
      },
      "self_employed_income": {
        "recognition_rate": 0.7,
        "documentation": "Latest 2 years tax assessment",
        "description": "70% of declared income"
      },
      "asset_based_income": {
        "pledged_assets": "30% of pledged amount / 48 months",
        "unpledged_assets": "Conditional assessment based on liquidity"
      }
    },
    
    "commitment_calculations": {
      "credit_cards": {
        "formula": "MAX(Outstanding_Balance × 3%, $50)",
        "description": "Per card minimum commitment"
      },
      "overdraft_facilities": {
        "formula": "Facility_Limit × 5%",
        "description": "Monthly commitment based on facility limit"
      },
      "guarantor_obligations": {
        "formula": "Guaranteed_Amount × 20%",
        "description": "20% of guaranteed loan amount"
      },
      "existing_mortgages": {
        "formula": "Actual monthly payment at stress test rate",
        "stress_test": "Same as new loan (4% residential, 5% commercial)"
      }
    },
    
    "ltv_limits": {
      "individual_borrowers": {
        "first_loan": {
          "max_ltv": 75,
          "min_cash": 5,
          "description": "75% LTV, minimum 5% cash, remainder CPF"
        },
        "second_loan": {
          "max_ltv": 45,
          "min_cash": 25,
          "description": "45% LTV, minimum 25% cash"
        },
        "third_plus_loan": {
          "max_ltv": 35,
          "min_cash": 25,
          "description": "35% LTV, minimum 25% cash"
        }
      },
      "corporate_buyers": {
        "max_ltv": 15,
        "description": "Maximum 15% LTV for entities"
      },
      "tenure_adjustments": {
        "extended_tenure": {
          "condition": "Tenure > 30 years OR extends past age 65",
          "ltv_reduction": "Reduce by 5% (e.g., 75% becomes 70%)",
          "cash_increase": "Increase minimum cash by 5%"
        }
      },
      "age_based_tenure": {
        "formula_hdb_ec": "MAX_TENURE = MIN(25, 65 - IWAA)",
        "formula_private": "MAX_TENURE = MIN(35, 75 - IWAA)",
        "description": "Maximum tenure limited by retirement age (65 for HDB/EC, 75 for private)",
        "note": "HDB/EC has additional 25-year maximum tenure restriction"
      }
    },
    
    "stamp_duty_rates": {
      "bsd_residential": {
        "description": "Buyer's Stamp Duty for residential properties",
        "tiers": [
          { "max": 180000, "rate": 0.01, "base": 0 },
          { "max": 360000, "rate": 0.02, "base": 1800 },
          { "max": 1000000, "rate": 0.03, "base": 5400 },
          { "max": 1500000, "rate": 0.04, "base": 24600 },
          { "max": 3000000, "rate": 0.05, "base": 44600 },
          { "above": 3000000, "rate": 0.06, "base": 119600 }
        ],
        "formula": "base + (value - previous_tier_max) × rate"
      },
      
      "bsd_commercial": {
        "description": "Buyer's Stamp Duty for non-residential properties",
        "tiers": [
          { "max": 180000, "rate": 0.01, "base": 0 },
          { "max": 360000, "rate": 0.02, "base": 1800 },
          { "max": 1000000, "rate": 0.03, "base": 5400 },
          { "max": 1500000, "rate": 0.04, "base": 24600 },
          { "above": 1500000, "rate": 0.05, "base": 44600 }
        ]
      },
      
      "absd_rates": {
        "description": "Additional Buyer's Stamp Duty rates",
        "single_buyers": {
          "singapore_citizen": {
            "first_property": 0,
            "second_property": 20,
            "third_plus": 30
          },
          "permanent_resident": {
            "first_property": 5,
            "second_property": 30,
            "third_plus": 35
          },
          "foreigner": {
            "all_properties": 60
          },
          "entity": {
            "all_properties": 65
          }
        },
        "married_couples": {
          "sc_sc": {
            "first": 0,
            "second": 20,
            "third_plus": 30
          },
          "sc_pr": {
            "first": 0,
            "second": 30,
            "third_plus": 35,
            "note": "Eligible for remission on first property"
          },
          "sc_foreigner": {
            "first": 0,
            "second_plus": 60,
            "note": "Eligible for remission on first property"
          },
          "pr_pr": {
            "first": 5,
            "second": 30,
            "third_plus": 35
          },
          "pr_foreigner": {
            "all": 60
          },
          "foreigner_foreigner": {
            "all": 60
          }
        },
        "joint_purchase_non_married": {
          "rule": "Highest individual rate applies to all buyers"
        }
      },
      
      "ssd_rates": {
        "description": "Seller's Stamp Duty based on holding period",
        "post_2017_03_11": {
          "year_1": 12,
          "year_2": 8,
          "year_3": 4,
          "year_4_plus": 0
        },
        "2011_01_14_to_2017_03_10": {
          "year_1": 16,
          "year_2": 12,
          "year_3": 8,
          "year_4": 4,
          "year_5_plus": 0
        },
        "pre_2011_01_14": 0
      }
    },
    
    "specialized_calculators": {
      "progressive_payment_buc": {
        "description": "Building Under Construction progressive payment schedule",
        "stages": [
          { "stage": "booking", "percentage": 5, "timing": "On Option Exercise", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "signing", "percentage": 15, "timing": "Within 8 weeks of Option", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "foundation", "percentage": 10, "timing": "Completion of Foundation (6 months)", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "reinforced_concrete", "percentage": 10, "timing": "Reinforced Concrete (11 months)", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "brick_walls", "percentage": 5, "timing": "Brick Walls (16 months)", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "roofing", "percentage": 5, "timing": "Roofing/Ceiling (20 months)", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "electrical", "percentage": 5, "timing": "Electrical Wiring (24 months)", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "carpark", "percentage": 5, "timing": "Carpark/Roads/Drains (28 months)", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "top", "percentage": 25, "timing": "Temporary Occupation Permit (33 months)", "payment_order": ["cash", "cpf", "loan"] },
          { "stage": "csc", "percentage": 15, "timing": "Certificate of Statutory Completion (45 months)", "payment_order": ["cash", "cpf", "loan"] }
        ],
        "payment_priority": "Cash first, then CPF, then Bank Loan",
        "interest_calculation": "Progressive based on disbursed amount"
      },
      
      "equity_term_loan": {
        "description": "Unlock equity from existing property",
        "max_equity_formula": "(Current_Market_Value × LTV%) - Outstanding_Loan - CPF_Used",
        "requirements": {
          "property_type": "Private property only",
          "status": "Must have obtained TOP",
          "servicing": "Cash only (no CPF allowed)",
          "max_tenure": "MIN(35 years, 75 - age) for private properties only"
        },
        "charge_priorities": [
          "1st: Outstanding housing loan",
          "2nd: CPF principal up to 100% valuation limit",
          "3rd: CPF beyond valuation limit + accrued interest",
          "4th: Legal costs and expenses",
          "5th: Equity term loan"
        ]
      },
      
      "roi_calculator": {
        "description": "Investment property return calculations",
        "metrics": {
          "gross_rental_yield": "(Annual_Rental / Property_Price) × 100",
          "net_rental_yield": "(Annual_Rental - Expenses) / Property_Price × 100",
          "cash_on_cash": "(Annual_Cash_Flow / Initial_Cash_Investment) × 100",
          "total_roi": "[(Sale_Price - Purchase_Price + Net_Rental) / Initial_Investment] × 100",
          "annualized_roi": "[(1 + Total_ROI)^(1/years) - 1] × 100"
        },
        "expenses_to_consider": [
          "Mortgage interest",
          "Property tax",
          "Maintenance fees",
          "Property management",
          "Insurance",
          "Vacancy allowance"
        ]
      },
      
      "nipp_calculator": {
        "description": "Variable interest rate projection calculator",
        "features": {
          "variable_rates": "Support for different rates in years 2-5 and thereafter",
          "calculation_modes": ["loan_amount", "tenure", "interest_rate", "monthly_payment"],
          "amortization_table": "Year-by-year breakdown with cumulative options"
        }
      }
    },
    
    "efa_modeling": {
      "description": "Eligible Financial Assets modeling for deficit coverage",
      "pledge_fund_calculation": {
        "formula": "(Monthly_Deficit / Limiting_Ratio) × 48",
        "exact_calculation": "(monthlyDeficit / limitingRatio) * 48",
        "client_display": "Math.ceil(exact_calculation / 1000) * 1000",
        "rounding_note": "Round UP to nearest thousand to ensure sufficient funds",
        "limiting_ratio": {
          "tdsr_limited": 0.55,
          "msr_limited": 0.30
        },
        "note": "Use the ratio of whichever is the limiting constraint"
      },
      "show_fund_calculation": {
        "formula": "Pledge_Fund / 0.30",
        "exact_calculation": "pledgeFund / 0.30",
        "client_display": "Math.ceil(exact_calculation / 1000) * 1000",
        "rounding_note": "Round UP to nearest thousand to ensure sufficient funds",
        "recognition": "30% of show fund amount",
        "note": "Show fund requires 3.33x the pledge amount"
      },
      "deficit_determination": {
        "formula": "MAX(0, Required_Monthly_Payment - Available_Under_Limit)",
        "exact_calculation": "Math.max(0, requiredPayment - availableLimit)",
        "client_display": "Math.ceil(exact_calculation)",
        "limiting_factor": "MIN(TDSR_Limit, MSR_Limit) for HDB/EC, TDSR_Limit for others"
      }
    },
    
    "multi_owner_calculations": {
      "combined_assessment": {
        "income": "Sum of all recognized incomes",
        "commitments": "Sum of all commitments",
        "tdsr": "Combined_Income × 0.55 - Combined_Commitments"
      },
      "individual_assessment": {
        "purpose": "Determine individual contribution capabilities",
        "calculation": "Each owner assessed separately, then combined"
      },
      "income_proportion": {
        "formula": "Owner_Income / Total_Income",
        "usage": "For determining fund allocation in individual mode"
      }
    },
    
    "property_specific_rules": {
      "hdb": {
        "msr_applicable": true,
        "max_tenure": 25,
        "cpf_usage": "Allowed",
        "eligibility": "Must meet HDB eligibility criteria",
        "grants": "Various grants available for first-timers"
      },
      "ec": {
        "msr_applicable": true,
        "max_tenure": 25,
        "cpf_usage": "Allowed",
        "privatization": "After 10 years"
      },
      "private": {
        "msr_applicable": false,
        "max_tenure": 35,
        "cpf_usage": "Allowed",
        "foreign_ownership": "Allowed for condominiums"
      },
      "commercial": {
        "msr_applicable": false,
        "max_tenure": 35,
        "cpf_usage": "Not allowed",
        "stress_test_rate": 5.0,
        "default_ltv": 80
      }
    }
  },
  
  "test_scenarios": {
    "scenario_1": {
      "description": "Single citizen first property",
      "inputs": {
        "property_price": 1000000,
        "property_type": "Private",
        "buyer_profile": "Singapore Citizen",
        "existing_properties": 0,
        "income": 10000,
        "commitments": 500
      },
      "expected_outputs": {
        "max_ltv": 75,
        "absd_rate": 0,
        "tdsr_available": 5000,
        "max_loan": "Calculate based on TDSR"
      }
    },
    "scenario_2": {
      "description": "HDB purchase with MSR constraint",
      "inputs": {
        "property_price": 600000,
        "property_type": "HDB",
        "income": 8000,
        "commitments": 200
      },
      "expected_outputs": {
        "msr_limit": 2400,
        "tdsr_limit": 4200,
        "limiting_factor": "MSR",
        "max_loan": "Based on MSR limit"
      }
    }
  },
  
  "validation_rules": {
    "input_validation": {
      "property_price": { "min": 0, "max": 99999999 },
      "income": { "min": 0, "max": 9999999 },
      "interest_rate": { "min": 0, "max": 20 },
      "tenure": { "min": 1, "max": 35 },
      "age": { "min": 21, "max": 100 }
    },
    "cross_field_validation": {
      "tenure_age": "Tenure + Age <= 65 (or 75 for private)",
      "ltv_property_count": "LTV decreases with property count",
      "msr_property_type": "MSR only for HDB/EC"
    }
  },
  
  "regulatory_compliance": {
    "last_update": "2024-04-01",
    "update_sources": [
      "MAS Notice 632",
      "MAS Notice 645",
      "HDB regulations",
      "IRAS tax guidelines"
    ],
    "change_log": [
      {
        "date": "2024-04-01",
        "changes": "Updated BSD rates for properties above $3M",
        "authority": "IRAS"
      }
    ]
  }
}